{"payload":{"meta":{"Graph":{"@Type":"81297157","@Value":{"Guid":"(Guid)7c732b83-8dac-49b3-8214-0909a2dbc00b","ParentGuid":"(Guid)3d853929-dfea-49d3-9ccd-f0b5d5e9e6d3","Name":"(string)M_2ConfigSercosIO","Properties":{"@Type":"2c41fa04:IDictionary","@Value":[{"@Key":"(Guid)24568a24-c491-472c-a21f-ee5d33859fab","@Value":{"@Type":"24568a24","@Value":{"MemoryReserveForOnlineChange":"(int)0","ExcludeFromBuild":"(bool)False","External":"(bool)False","EnableSystemCall":"(bool)False","CompilerDefines":"(string)","LinkAlways":"(bool)False","Undefines":{"@Type":"[string]","@Value":[]}}}}]},"TypeGuid":"(Guid)f8a58466-d7f6-439f-bbb8-d4600e41d099","EmbeddedTypeGuids":{"@Type":"[Guid]","@Value":["(Guid)a9ed5b7e-75c5-4651-af16-d2c27e98cb94","(Guid)3b83b776-fb25-43b8-99f2-3c507c9143fc"]}}},"TypeInfos":{"24568a24":"{24568a24-c491-472c-a21f-ee5d33859fab}","2c41fa04":"{2c41fa04-1834-41c1-816e-303c7aa2c05b}","81297157":"{81297157-7ec9-45ce-845e-84cab2b88ade}","bool":"System.Boolean","Guid":"System.Guid","int":"System.Int32","string":"System.String"}},"object":{"Graph":{"@Type":"f8a58466","@Value":{"Implementation":{"@Type":"3b83b776","@Value":{"TextDocument":{"@Type":"f3878285","@Value":{"TextBlobForSerialisation":"(string)\nCASE iState OF \n\n(* ################################################################################ *)\t\n\t// enable SIII Buscoupler \n(* ################################################################################ *)\t\n\t200: \n\t\tM_DelStructure(ADR(sRingString), SIZEOF(sRingString));\n\t\tM_DelStructure(ADR(apsElements), SIZEOF(apsElements));\t\n\t\tM_DelStructure(ADR(refastSercosIOConfigError), SIZEOF(refastSercosIOConfigError));\n//\t\tM_DelStructure(ADR(SercosIOCmdConfigError), SIZEOF(SercosIOCmdConfigError));\n//\t\tM_DelStructure(ADR(SercosIOActConfig_tmp), SIZEOF(SercosIOActConfig_tmp));\t\n\t\tM_DelStructure(ADR(abSercosIOFoundInConfig), SIZEOF(abSercosIOFoundInConfig));\t\n\t\t\n\t\t\n\t\tIF IN_bConfigSercosIO \n\t\t\tAND IN_bCheckSercosIOConfig THEN\n\t\t\tiState := 210;\t\t\t\n\t\tELSIF IN_bConfigSercosIO THEN\n\t\t\tiState := 230;\n\t\tELSIF IN_bCheckSercosIOConfig THEN\n\t\t\tiState := 210;\n\t\tELSIF IN_bWriteSercosIOAddress THEN \n\t\t\tiState := 290;\t\n\t\tELSE\n\t\t\tiState := 299;\n\t\tEND_IF\n\n(* ################################################################################ *)\t\n\t// validity check if enough IOs are found and configured \n\t// Check also correct sercos Adress if WriteSercosIOAddress is not enabled\n(* ################################################################################ *)\t\n\t210:\n\t\tk := 1;\n\t\tbIOFound := FALSE;\n\t\tIF NOT IN_bWriteSercosIOAddress THEN\n\t\t\tFOR i := 1 TO iMAX_SERCOS_IO DO\t\n\t\t\t\t\t\n\t\t\t\t// Reset Error Struct\n\t\t\t\trefastSercosIOConfigError[i].bError := FALSE;\n\t\t\t\trefastSercosIOConfigError[i].sErrorMessage := '';\n\t\t\t\trefastSercosIOConfigError[i].bIOFoundAndNotConfigured := FALSE;\t\n\t\t\t\trefastSercosIOConfigError[i].bIOConfiguredAndNotFound := FALSE;\n\t\t\t\trefastSercosIOConfigError[i].bWrongSercosAddress := FALSE;\n\t\t\t\trefastSercosIOConfigError[i].iSercosAddress := 0;\n\t\t\t\trefastSercosIOConfigError[i].bWrongIOModuleType := FALSE;\n\t\t\t\t\n\t\t\t\tIF NOT (refastSercosIOCmdConfig[i].iSercosAddress = 0) THEN \t\n\t\t\t\t\t// search trough ActConfig\n\t\t\t\t\tFOR j := 1 TO iMAX_SERCOS_IO DO\n\t\t\t\t\t\tabSercosIOFoundInConfig[i] := FALSE;\n\t\t\t\t\t\tIF refastSercosIOCmdConfig[i].iSercosAddress = refastSercosIOActConfig[j].iSercosAddress THEN\n\t\t\t\t\t\t\tbIOFound := TRUE;\n\t\t\t\t\t\t\tabSercosIOFoundInConfig[i] := TRUE;\n\t\t\t\t\t\t\tastSercosIOActConfigTmp[i] := refastSercosIOActConfig[j];\n\t\t\t\t\t\t\tIF NOT refastSercosIOCmdConfig[i].bActive AND astSercosIOActConfigTmp[i].bAvailable THEN\n\t\t \t\t\t\t\t\trefastSercosIOConfigError[i].bIOFoundAndNotConfigured := TRUE;\n\t\t\t\t\t\t\t\trefastSercosIOConfigError[i].iSercosAddress := astSercosIOActConfigTmp[i].iSercosAddress;\t\n\t\t\t\t\t\t\t\trefastSercosIOConfigError[i].sName := '';\t\n\t\t\t\t\t\t\t//ELSIF SercosIOCmdConfig[i].Active AND NOT SercosIOActConfig_tmp[i].Available THEN\n\t\t\t\t\t\t\t//\tSercosIOConfigError[i].IOConfiguredAndNotFound := TRUE;\n\t\t\t\t\t\t\tELSIF refastSercosIOCmdConfig[i].bActive AND astSercosIOActConfigTmp[i].bAvailable THEN\n\t\t\t\t\t\t\t\tIF IN_bCheckSercosIOModuleConfig THEN\n\t\t\t\t\t\t\t\t\t// Check if number of found modules = configured modules \n\t\t\t\t\t\t\t\t\tastSercosIOActConfigTmp[i].uiNoOfIO_Modules := 0;\t\n\t\t\t\t\t\t\t\t\trefastSercosIOCmdConfig[i].uiNoOfIOModules := 0;\t\n\t\t\t\t\t\t\t\t\tFOR k := 1 TO iMAX_MODULE_ON_SERCOS_IO DO\n\t\t\t\t\t\t\t\t\t\t// Count configured Modules\n\t\t\t\t\t\t\t\t\t\tIF refastSercosIOCmdConfig[i].astIOModule[k].bActive THEN\t\n\t\t\t\t\t\t\t\t\t\t\trefastSercosIOCmdConfig[i].uiNoOfIOModules := refastSercosIOCmdConfig[i].uiNoOfIOModules +1;\n\t\t\t\t\t\t\t\t\t\tEND_IF \n\t\t\t\t\t\t\t\t\t\t// Count found Modules\n\t\t\t\t\t\t\t\t\t\tIF astSercosIOActConfigTmp[i].astIOModule[k].bAvailable THEN\t\n\t\t\t\t\t\t\t\t\t\t\tastSercosIOActConfigTmp[i].uiNoOfIO_Modules := astSercosIOActConfigTmp[i].uiNoOfIO_Modules +1;\n\t\t\t\t\t\t\t\t\t\tEND_IF\n\t\t\t\t\t\t\t\t\tEND_FOR\n\t\t\t\t\t\t\t\t\tIF (refastSercosIOCmdConfig[i].uiNoOfIOModules > astSercosIOActConfigTmp[i].uiNoOfIO_Modules) THEN\n\t\t\t\t\t\t\t\t\t\trefastSercosIOConfigError[i].bMoreIOModulesConfiguredThanFound := TRUE;\n\t\t\t\t\t\t\t\t\t\trefastSercosIOConfigError[i].iSercosAddress := refastSercosIOCmdConfig[i].iSercosAddress;\n\t\t\t\t\t\t\t\t\t\trefastSercosIOConfigError[i].sName := refastSercosIOCmdConfig[i].sName;\n\t\t\t\t\t\t\t\t\tELSIF (astSercosIOActConfigTmp[i].uiNoOfIO_Modules > refastSercosIOCmdConfig[i].uiNoOfIOModules ) THEN\n\t\t\t\t\t\t\t\t\t\trefastSercosIOConfigError[i].bMoreIOModulesFoundThanConfigured := TRUE;\n\t\t\t\t\t\t\t\t\t\trefastSercosIOConfigError[i].iSercosAddress := refastSercosIOCmdConfig[i].iSercosAddress;\n\t\t\t\t\t\t\t\t\t\trefastSercosIOConfigError[i].sName := refastSercosIOCmdConfig[i].sName;\n\t\t\t\t\t\t\t\t\tELSE\n\t\t\t\t\t\t\t\t\t\trefastSercosIOConfigError[i].bMoreIOModulesConfiguredThanFound := FALSE;\t\n\t\t\t\t\t\t\t\t\t\trefastSercosIOConfigError[i].bMoreIOModulesFoundThanConfigured := FALSE;\t\t\n\t\t\t\t\t\t\t\t\tEND_IF\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t// IF number of found modules = configured modules check if type is OK\n\t\t\t\t\t\t\t\t\tIF NOT refastSercosIOConfigError[i].bMoreIOModulesConfiguredThanFound AND NOT refastSercosIOConfigError[i].bMoreIOModulesFoundThanConfigured THEN\n\t\t\t\t\t\t\t\t\t\tl := 0;\n\t\t\t\t\t\t\t\t\t\tFOR k := 1 TO iMAX_MODULE_ON_SERCOS_IO DO\n\t\t\t\t\t\t\t\t\t\t\tIF astSercosIOActConfigTmp[i].astIOModule[k].bAvailable THEN\n\t\t\t\t\t\t\t\t\t\t\t\tl := l+1;\n\t\t\t\t\t\t\t\t\t\t\t\tWHILE (NOT refastSercosIOCmdConfig[i].astIOModule[l].bActive) AND NOT (l = iMAX_MODULE_ON_SERCOS_IO) DO\n\t\t\t\t\t\t\t\t\t\t\t\t\tl := l+1;\n\t\t\t\t\t\t\t\t\t\t\t\tEND_WHILE\n\t\t\t\t\t\t\t\t\t\t\t\tIF NOT (refastSercosIOCmdConfig[i].astIOModule[l].eIOType = astSercosIOActConfigTmp[i].astIOModule[k].IOType) THEN\n\t\t\t\t\t\t\t\t\t\t\t\t\trefastSercosIOConfigError[i].astIO_Module[l].bWrongIOType := TRUE;\n\t\t\t\t\t\t\t\t\t\t\t\t\trefastSercosIOConfigError[i].bWrongIOModuleType := TRUE;\n\t\t\t\t\t\t\t\t\t\t\t\t\trefastSercosIOConfigError[i].iSercosAddress := refastSercosIOCmdConfig[i].iSercosAddress;\n\t\t\t\t\t\t\t\t\t\t\t\t\trefastSercosIOConfigError[i].sName := refastSercosIOCmdConfig[i].sName;\n\t\t\t\t\t\t\t\t\t\t\t\tELSE\t\n\t\t\t\t\t\t\t\t\t\t\t\t\trefastSercosIOConfigError[i].astIO_Module[l].bWrongIOType := FALSE;\t\n\t\t\t\t\t\t\t\t\t\t\t\tEND_IF\n\t\t\t\t\t\t\t\t\t\t\tEND_IF\n\t\t\t\t\t\t\t\t\t\tEND_FOR\n\t\t\t\t\t\t\t\t\tEND_IF\n\t\t\t\t\t\t\t\tEND_IF\t\n\t\t\t\t\t\t\tEND_IF\n\t\t\t\t\t\t\tj := iMAX_SERCOS_IO + 1; // Loop END\n\t\t\t\t\t\tEND_IF\n\t\t\t\t\tEND_FOR\n\t\t\t\t\t\n\t\t\t\t\t// if not found in ActConfig\n\t\t\t\t\tIF NOT bIOFound AND refastSercosIOCmdConfig[i].bActive THEN\n\t\t\t\t\t\trefastSercosIOConfigError[i].bIOConfiguredAndNotFound := TRUE;\n\t\t\t\t\t\trefastSercosIOConfigError[i].iSercosAddress := refastSercosIOCmdConfig[i].iSercosAddress;\n\t\t\t\t\t\trefastSercosIOConfigError[i].sName := refastSercosIOCmdConfig[i].sName;\t\n\t\t\t\t\tEND_IF\n\t\t\t\t\tbIOFound := FALSE;\n\t\t\t\tEND_IF\t\n\t\t\tEND_FOR\n\t\tEND_IF\n\n\t\t// to have same index like SercosIOCmdConfig\n\t\tFOR i := 1 TO iMAX_SERCOS_IO DO\n\t\t\trefastSercosIOActConfig[i] := astSercosIOActConfigTmp[i];\n\t\tEND_FOR\n\t\t\n\t\tiState := 220;\t\n\n(* ################################################################################ *)\t\n\t// generate Error if necessary \n(* ################################################################################ *)\t\n\t220:\n\t\tFOR i := 1 TO iMAX_SERCOS_IO DO\n\t\t\tIF refastSercosIOConfigError[i].bWrongSercosAddress\t\n\t\t\t\tOR refastSercosIOConfigError[i].bIOFoundAndNotConfigured \n\t\t\t\tOR refastSercosIOConfigError[i].bIOConfiguredAndNotFound \n\t\t\t\tOR refastSercosIOConfigError[i].bMoreIOModulesConfiguredThanFound\n\t\t\t\tOR refastSercosIOConfigError[i].bMoreIOModulesFoundThanConfigured\t \n\t\t\t\tOR refastSercosIOConfigError[i].bWrongIOModuleType THEN\n\t\t\t\t\trefastSercosIOConfigError[i].bError := TRUE;\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\tbErrorTemp := TRUE;\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t// Create Error Message\n\t\t\t\t\trefastSercosIOConfigError[i].sErrorMessage := 'sercos IO ';\n\t\t\t\t\tsTemp2 := refastSercosIOConfigError[i].sName ;\n\t\t\t\t\t//strConcat(ADR\t(SercosIOConfigError[i].ErrorMessage), SIZEOF(SercosIOConfigError[i].ErrorMessage) ,\tADR(strTemp));\n\t\t\t\t\tIL_CONCAT(ADR(refastSercosIOConfigError[i].sErrorMessage), ADR(sTemp2), ADR(refastSercosIOConfigError[i].sErrorMessage), SIZEOF(refastSercosIOConfigError[i].sErrorMessage));\n\t\t\t\t\tsTemp2 :=  ' with address '; ;\n\t\t\t\t\t//strConcat(ADR\t(SercosIOConfigError[i].ErrorMessage), SIZEOF(SercosIOConfigError[i].ErrorMessage) ,\tADR(strTemp));\n\t\t\t\t\tIL_CONCAT(ADR(refastSercosIOConfigError[i].sErrorMessage), ADR(sTemp2), ADR(refastSercosIOConfigError[i].sErrorMessage), SIZEOF(refastSercosIOConfigError[i].sErrorMessage));\n\t\t\t\t\tsTemp2 := INT_TO_STRING(refastSercosIOConfigError[i].iSercosAddress);\n\t\t\t\t\t//strConcat(ADR\t(SercosIOConfigError[i].ErrorMessage), SIZEOF(SercosIOConfigError[i].ErrorMessage) ,\tADR(strTemp));\n\t\t\t\t\tIL_CONCAT(ADR(refastSercosIOConfigError[i].sErrorMessage), ADR(sTemp2), ADR(refastSercosIOConfigError[i].sErrorMessage), SIZEOF(refastSercosIOConfigError[i].sErrorMessage));\n\t\t\t\t\tsTemp2 := ' shows error: ';\n\t\t\t\t\t//strConcat(ADR\t(SercosIOConfigError[i].ErrorMessage), SIZEOF(SercosIOConfigError[i].ErrorMessage) ,\tADR(strTemp));\n\t\t\t\t\tIL_CONCAT(ADR(refastSercosIOConfigError[i].sErrorMessage), ADR(sTemp2), ADR(refastSercosIOConfigError[i].sErrorMessage), SIZEOF(refastSercosIOConfigError[i].sErrorMessage));\n\t\t\t\t\tsTemp2 :='';\n\t\t\t\t\tIF refastSercosIOConfigError[i].bWrongSercosAddress\tTHEN\n\t\t\t\t\t\tsTemp2 :='wrong sercos address';\n\t\t\t\t\t\t//strConcat(ADR\t(SercosIOConfigError[i].ErrorMessage), SIZEOF(SercosIOConfigError[i].ErrorMessage) ,\tADR(strTemp));\n\t\t\t\t\t\tIL_CONCAT(ADR(refastSercosIOConfigError[i].sErrorMessage), ADR(sTemp2), ADR(refastSercosIOConfigError[i].sErrorMessage), SIZEOF(refastSercosIOConfigError[i].sErrorMessage));\n\t\t\t\t\t\tsTemp2 :=', ';\n\t\t\t\t\tEND_IF\n\t\t\t\t\t\n\t\t\t\t\tIF refastSercosIOConfigError[i].bIOConfiguredAndNotFound\tTHEN\n\t\t\t\t\t\t//strConcat(ADR\t(SercosIOConfigError[i].ErrorMessage), SIZEOF(SercosIOConfigError[i].ErrorMessage) ,\tADR(strTemp));\n\t\t\t\t\t\tIL_CONCAT(ADR(refastSercosIOConfigError[i].sErrorMessage), ADR(sTemp2), ADR(refastSercosIOConfigError[i].sErrorMessage), SIZEOF(refastSercosIOConfigError[i].sErrorMessage));\n\t\t\t\t\t\tsTemp2 :='configured but not found';\n\t\t\t\t\t\t//strConcat(ADR\t(SercosIOConfigError[i].ErrorMessage), SIZEOF(SercosIOConfigError[i].ErrorMessage) ,\tADR(strTemp));\n\t\t\t\t\t\tIL_CONCAT(ADR(refastSercosIOConfigError[i].sErrorMessage), ADR(sTemp2), ADR(refastSercosIOConfigError[i].sErrorMessage), SIZEOF(refastSercosIOConfigError[i].sErrorMessage));\n\t\t\t\t\t\tsTemp2 :=', ';\n\t\t\t\t\tEND_IF\n\t\t\t\t\t\n\t\t\t\t\tIF refastSercosIOConfigError[i].bIOFoundAndNotConfigured\tTHEN\n\t\t\t\t\t\t//strConcat(ADR\t(SercosIOConfigError[i].ErrorMessage), SIZEOF(SercosIOConfigError[i].ErrorMessage) ,\tADR(strTemp));\n\t\t\t\t\t\tIL_CONCAT(ADR(refastSercosIOConfigError[i].sErrorMessage), ADR(sTemp2), ADR(refastSercosIOConfigError[i].sErrorMessage), SIZEOF(refastSercosIOConfigError[i].sErrorMessage));\n\t\t\t\t\t\tsTemp2 :='found but not configured in DeviceCmdConfig';\n\t\t\t\t\t\t//strConcat(ADR\t(SercosIOConfigError[i].ErrorMessage), SIZEOF(SercosIOConfigError[i].ErrorMessage) ,\tADR(strTemp));\n\t\t\t\t\t\tIL_CONCAT(ADR(refastSercosIOConfigError[i].sErrorMessage), ADR(sTemp2), ADR(refastSercosIOConfigError[i].sErrorMessage), SIZEOF(refastSercosIOConfigError[i].sErrorMessage));\n\t\t\t\t\t\tsTemp2 :=', ';\n\t\t\t\t\tEND_IF\t\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\tIF refastSercosIOConfigError[i].bMoreIOModulesConfiguredThanFound THEN\n\t\t\t\t\t\t//strConcat(ADR\t(SercosIOConfigError[i].ErrorMessage), SIZEOF(SercosIOConfigError[i].ErrorMessage) ,\tADR(strTemp));\n\t\t\t\t\t\tIL_CONCAT(ADR(refastSercosIOConfigError[i].sErrorMessage), ADR(sTemp2), ADR(refastSercosIOConfigError[i].sErrorMessage), SIZEOF(refastSercosIOConfigError[i].sErrorMessage));\n\t\t\t\t\t\tsTemp2 :='more IO Modules configured than found';\n\t\t\t\t\t\t//strConcat(ADR\t(SercosIOConfigError[i].ErrorMessage), SIZEOF(SercosIOConfigError[i].ErrorMessage) ,\tADR(strTemp));\n\t\t\t\t\t\tIL_CONCAT(ADR(refastSercosIOConfigError[i].sErrorMessage), ADR(sTemp2), ADR(refastSercosIOConfigError[i].sErrorMessage), SIZEOF(refastSercosIOConfigError[i].sErrorMessage));\n\t\t\t\t\t\tsTemp2 :=', ';\n\t\t\t\t\tEND_IF\t\n\t\t\t\t\t\n\t\t\t\t\tIF refastSercosIOConfigError[i].bMoreIOModulesFoundThanConfigured THEN\n\t\t\t\t\t\t//strConcat(ADR\t(SercosIOConfigError[i].ErrorMessage), SIZEOF(SercosIOConfigError[i].ErrorMessage) ,\tADR(strTemp));\n\t\t\t\t\t\tIL_CONCAT(ADR(refastSercosIOConfigError[i].sErrorMessage), ADR(sTemp2), ADR(refastSercosIOConfigError[i].sErrorMessage), SIZEOF(refastSercosIOConfigError[i].sErrorMessage));\n\t\t\t\t\t\tsTemp2 :='less IO Modules configured than found';\n\t\t\t\t\t\t//strConcat(ADR\t(SercosIOConfigError[i].ErrorMessage), SIZEOF(SercosIOConfigError[i].ErrorMessage) ,\tADR(strTemp));\n\t\t\t\t\t\tIL_CONCAT(ADR(refastSercosIOConfigError[i].sErrorMessage), ADR(sTemp2), ADR(refastSercosIOConfigError[i].sErrorMessage), SIZEOF(refastSercosIOConfigError[i].sErrorMessage));\n\t\t\t\t\t\tsTemp2 :=', ';\n\t\t\t\t\tEND_IF\t\n\t\t\t\t\t\n\t\t\t\t\tIF refastSercosIOConfigError[i].bWrongIOModuleType THEN\n\t\t\t\t\t\t//'wrong IO Module Type: Module 1: expected SSDIxxx - found: SSDOxx ';\n\t\t\t\t\t\tFOR j := 1 TO iMAX_MODULE_ON_SERCOS_IO DO\n\t\t\t\t\t\t\tIF refastSercosIOConfigError[i].astIO_Module[j].bWrongIOType THEN\n\t\t\t\t\t\t\t\t//strConcat(ADR\t(SercosIOConfigError[i].ErrorMessage), SIZEOF(SercosIOConfigError[i].ErrorMessage) ,\tADR(strTemp));\n\t\t\t\t\t\t\t\tIL_CONCAT(ADR(refastSercosIOConfigError[i].sErrorMessage), ADR(sTemp2), ADR(refastSercosIOConfigError[i].sErrorMessage), SIZEOF(refastSercosIOConfigError[i].sErrorMessage));\n\t\t\t\t\t\t\t\tsTemp2 :='wrong IO Module Type: Module ';\n\t\t\t\t\t\t\t\t//strConcat(ADR\t(SercosIOConfigError[i].ErrorMessage), SIZEOF(SercosIOConfigError[i].ErrorMessage) ,\tADR(strTemp));\n\t\t\t\t\t\t\t\tIL_CONCAT(ADR(refastSercosIOConfigError[i].sErrorMessage), ADR(sTemp2), ADR(refastSercosIOConfigError[i].sErrorMessage), SIZEOF(refastSercosIOConfigError[i].sErrorMessage));\n\t\t\t\t\t\t\t\tsTemp2 := INT_TO_STRING (j);\n\t\t\t\t\t\t\t\t//strConcat(ADR\t(SercosIOConfigError[i].ErrorMessage), SIZEOF(SercosIOConfigError[i].ErrorMessage) ,\tADR(strTemp));\n\t\t\t\t\t\t\t\tIL_CONCAT(ADR(refastSercosIOConfigError[i].sErrorMessage), ADR(sTemp2), ADR(refastSercosIOConfigError[i].sErrorMessage), SIZEOF(refastSercosIOConfigError[i].sErrorMessage));\n\t\t\t\t\t\t\t\tsTemp2 :=': expected: ';\n\t\t\t\t\t\t\t\t//strConcat(ADR\t(SercosIOConfigError[i].ErrorMessage), SIZEOF(SercosIOConfigError[i].ErrorMessage) ,\tADR(strTemp));\n\t\t\t\t\t\t\t\tIL_CONCAT(ADR(refastSercosIOConfigError[i].sErrorMessage), ADR(sTemp2), ADR(refastSercosIOConfigError[i].sErrorMessage), SIZEOF(refastSercosIOConfigError[i].sErrorMessage));\n\t\t\t\t\t\t\t\tsTemp2 := M_S20TypeToString(refastSercosIOCmdConfig[i].astIOModule[j].eIOType);\n\t\t\t\t\t\t\t\t//strConcat(ADR\t(SercosIOConfigError[i].ErrorMessage), SIZEOF(SercosIOConfigError[i].ErrorMessage) ,\tADR(strTemp));\n\t\t\t\t\t\t\t\tIL_CONCAT(ADR(refastSercosIOConfigError[i].sErrorMessage), ADR(sTemp2), ADR(refastSercosIOConfigError[i].sErrorMessage), SIZEOF(refastSercosIOConfigError[i].sErrorMessage));\n\t\t\t\t\t\t\t\tsTemp2 :=' - found: ';\n\t\t\t\t\t\t\t\t//strConcat(ADR\t(SercosIOConfigError[i].ErrorMessage), SIZEOF(SercosIOConfigError[i].ErrorMessage) ,\tADR(strTemp));\n\t\t\t\t\t\t\t\tIL_CONCAT(ADR(refastSercosIOConfigError[i].sErrorMessage), ADR(sTemp2), ADR(refastSercosIOConfigError[i].sErrorMessage), SIZEOF(refastSercosIOConfigError[i].sErrorMessage));\n\t\t\t\t\t\t\t\tsTemp2 := M_S20TypeToString(refastSercosIOActConfig[i].astIOModule[j].IOType);\n\t\t\t\t\t\t\t\t//strConcat(ADR\t(SercosIOConfigError[i].ErrorMessage), SIZEOF(SercosIOConfigError[i].ErrorMessage) ,\tADR(strTemp));\n\t\t\t\t\t\t\t\tIL_CONCAT(ADR(refastSercosIOConfigError[i].sErrorMessage), ADR(sTemp2), ADR(refastSercosIOConfigError[i].sErrorMessage), SIZEOF(refastSercosIOConfigError[i].sErrorMessage));\n\t\t\t\t\t\t\t\tsTemp2 :=', ';\n\t\t\t\t\t\t\tEND_IF\n\t\t\t\t\t\tEND_FOR\n\t\t\t\t\tEND_IF\t\n\t\t\t\t\t\n\t\t\t\t\tML_SetDiagEntry(\n\t\t\t\t\t\tSeverity:= enSeverity, \n\t\t\t\t\t\tClass:= enClass, \n\t\t\t\t\t\tFacility:= E_LOG_FACILITY.USER, \n\t\t\t\t\t\tCode:= wDIAG_CODE, \n\t\t\t\t\t\tText:= ADR(refastSercosIOConfigError[i].sErrorMessage));\n\t\t\t\t\t\n\t\t\t\t\tIF sDiagMessageInt = '' THEN\n\t\t\t\t\t\tsDiagMessageInt := refastSercosIOConfigError[i].sErrorMessage;\n\t\t\t\t\tEND_IF\t\t\t\n\t\t\t\t\t\t\n\t\t\tEND_IF\n\t\tEND_FOR\n\t\t\t\n\t\tIF bErrorTemp THEN  \n\t\t\tOUT_ErrorID := \tRESOURCE_ERROR;\n\t\t\tOUT_ErrorIdent.Table :=\tUSER1_TABLE;       \n\t\t\tOUT_ErrorIdent.Additional1 := 16#F0003;\n\t\t\tOUT_ErrorIdent.Additional2 := 16#F0000;\n\n\t\t\tiState \t\t:= 998;\n\t\tELSIF IN_bConfigSercosIO THEN\n\t\t\tiState \t\t:= 230;\n\t\tELSIF IN_bWriteSercosIOAddress THEN \n\t\t\tiState \t\t:= 290;\n\t\tELSE\t\n\t\t\tiState \t\t:= 299;\n\t\tEND_IF\t\t\n\t\t\n\t\t\n\t\t\n(* ################################################################################ *)\t\n\t// validity check if IO config in C-0-0478 matches to SercosIOCmdConfig\n(* ################################################################################ *)\t\t\n\t230:\n\t\tj:= 1;\n\t\n\t\tFOR i := 1 TO iMAX_SERCOS_IO DO\n\t\t\tIF refastSercosIOActConfigC578[i].bAvailable AND (refastSercosIOCmdConfig[i].iSercosAddress <> 0) THEN\n\t\t\t\t; // OK\n\t\t\t\tbLoopEnd := FALSE;\n\t\t\t\tREPEAT\n\t\t\t\t\tIF j <= iMAX_SERCOS_IO THEN\n\t\t\t\t\t\tIF refastSercosIOActConfig[i].bAvailable AND refastSercosIOCmdConfig[j].bActive THEN\n\t\t\t\t\t\t\tastSercosIOActConfigTmp[j].sName := refastSercosIOCmdConfig[j].sName;\n\t\t\t\t\t\t\tastSercosIOActConfigTmp[j].sTypeCode := refastSercosIOActConfig[i].sTypeCode;\n\t\t\t\t\t\t\tastSercosIOActConfigTmp[j].astIOModule := refastSercosIOActConfig[i].astIOModule;\n\t\t\t\t\t\t\tastSercosIOActConfigTmp[j].bAvailable := TRUE;\n\t\t\t\t\t\t\tastSercosIOActConfigTmp[j].iSercosAddress := refastSercosIOCmdConfig[j].iSercosAddress;\n\t\t\t\t\t\t\tj := j+1;\n\t\t\t\t\t\t\tbLoopend := TRUE;\n\t\t\t\t\t\tELSIF refastSercosIOActConfig[i].bAvailable AND NOT refastSercosIOCmdConfig[j].bActive THEN\n\t\t\t\t\t\t\tastSercosIOActConfigTmp[j].sName := refastSercosIOCmdConfig[j].sName;\n\t\t\t\t\t\t\t//SercosIOActConfig_tmp[j].TypeCode := SercosIOActConfig[j].TypeCode;\n\t\t\t\t\t\t\tastSercosIOActConfigTmp[j].sTypeCode := '';\n\t\t\t\t\t\t\tastSercosIOActConfigTmp[j].bAvailable := FALSE;\n\t\t\t\t\t\t\tastSercosIOActConfigTmp[j].iSercosAddress := refastSercosIOCmdConfig[j].iSercosAddress;\n\t\t\t\t\t\t\tj := j+1;\n\t\t\t\t\t\tELSIF NOT refastSercosIOActConfig[i].bAvailable AND (refastSercosIOCmdConfig[j].iSercosAddress <> 0) THEN \n\t\t\t\t\t\t\tastSercosIOActConfigTmp[j].sName := refastSercosIOCmdConfig[j].sName;\n\t\t\t\t\t\t\t//SercosIOActConfig_tmp[j].TypeCode := SercosIOActConfig[j].TypeCode;\n\t\t\t\t\t\t\tastSercosIOActConfigTmp[j].sTypeCode := '';\n\t\t\t\t\t\t\tastSercosIOActConfigTmp[j].bAvailable := FALSE;\n\t\t\t\t\t\t\tastSercosIOActConfigTmp[j].iSercosAddress := refastSercosIOCmdConfig[j].iSercosAddress;\n\t\t\t\t\t\t\tj := j+1;\n\t\t\t\t\t\tELSE\t\n\t\t\t\t\t\t\tj := j+1;\n\t\t\t\t\t\tEND_IF\n\t\t\t\t\tELSE\t\n\t\t\t\t\t\tbLoopEnd := TRUE;\n\t\t\t\t\tEND_IF\t\n\t\t\t\tUNTIL bLoopEnd\n\t\t\t\tEND_REPEAT\n\t\t\t\t\n//\t\t\tELSIF NOT\tSercosIOActConfigC578[i].Available AND (SercosIOCmdConfig[i].SercosAddress <> 0) THEN\n//\t\t\t\t; // Too many IO configured in DeviceCmdConfig.sercos_IO\n//\t\t\t\tSercosIOCmdConfigError.Error := TRUE;\n//\t\t\t\tSercosIOCmdConfigError.TooManyIOConfigured := TRUE; \n//\t\t\t\tSercosIOCmdConfigError.SercosAddress := SercosIOCmdConfig[i].SercosAddress;\n//\t\t\t\tSercosIOCmdConfigError.Name := SercosIOCmdConfig[i].Name;\n//\t\t\t\tSercosIOCmdConfigError.ErrorMessage := 'Too many IO stations configured in DeviceCmdConfig.sercos_IO';\n//\t\t\t\ti := MAX_SERCOS_IO +1; // end loop\n//\t\t\tELSIF SercosIOActConfigC578[i].Available AND (SercosIOCmdConfig[i].SercosAddress = 0) THEN\t\n//\t\t\t\t; // Too less IO configured in DeviceCmdConfig.sercos_IO\n//\t\t\t\tSercosIOCmdConfigError.Error := TRUE;\n//\t\t\t\tSercosIOCmdConfigError.TooLessIOConfigured := TRUE; \n//\t\t\t\tSercosIOCmdConfigError.SercosAddress := SercosIOActConfigC578[i].SercosAddress;\n//\t\t\t\tSercosIOCmdConfigError.ErrorMessage := 'Too less IO stations configured in DeviceCmdConfig.sercos_IO';\n//\t\t\t\ti := MAX_SERCOS_IO +1; // end loop\n\t\t\tEND_IF\n\t\t\t\n\t\t\t// Write Message to MLC Log\n//\t\t\tIF SercosIOCmdConfigError.Error THEN\n//\t\t\t\tbError_temp := TRUE;\t\n//\t\t\t\tML_SetDiagEntry(\n//\t\t\t\t\tSeverity:= enSeverity, \n//\t\t\t\t\tClass:= enClass, \n//\t\t\t\t\tFacility:= E_LOG_FACILITY.USER, \n//\t\t\t\t\tCode:= wDiagCode, \n//\t\t\t\t\tText:= ADR(SercosIOCmdConfigError.ErrorMessage));\n//\t\t\t\t\t\n//\t\t\t\tIF strDiagMessage_int = '' THEN\n//\t\t\t\t\tstrDiagMessage_int := SercosIOCmdConfigError.ErrorMessage;\n//\t\t\t\tEND_IF\t\t\t\n//\t\n//\t\t\tEND_IF\n\t\tEND_FOR\n\t\n\t\tIF bErrorTemp THEN  \n\t\t\tOUT_ErrorID := \tRESOURCE_ERROR;\n\t\t\tOUT_ErrorIdent.Table :=\tUSER1_TABLE;       \n\t\t\tOUT_ErrorIdent.Additional1 := 16#F0004;\n\t\t\tOUT_ErrorIdent.Additional2 := 16#F0000;\n\t\t\tiState \t\t:= 998;\n\t\tELSE\t\n\t\t\tM_DelStructure(ADR(refastSercosIOActConfig), SIZEOF(refastSercosIOActConfig));\t\n\t\t\tFOR i := 1 TO iMAX_SERCOS_IO DO\n\t\t\t\trefastSercosIOActConfig[i] := astSercosIOActConfigTmp[i];\n\t\t\tEND_FOR\n\t\n\t\t\tiState \t\t:= 280;\n\t\tEND_IF\t\t\n\n\n(* ################################################################################ *)\t\n\t// Read actual configuration C-0-0578\n(* ################################################################################ *)\n\n\t\t\n(*\t\t\n(* ################################################################################ *)\t\n\t// Read actual configuration C-0-0578\n(* ################################################################################ *)\t\t\t\n\t235:\n\t\tfbReadListParameter(\n\t\t\tExecute\t\t\t:= TRUE, \n\t\t\tParameterNumber\t:= GVL_C_Param_ID.FP_C_0_0578, \n\t\t\tNoOfBytes\t\t:= SIZEOF(sRingString), \n\t\t\tValueAdr\t\t:= ADR(sRingString), \n\t\t\tAxis\t\t\t:= NoAxis);\n\t\t\t\n\t\t\tIF fbReadListParameter.Done THEN\n\t\t\t\tfbReadListParameter(Execute\t:= FALSE,\n\t\t\t\t\t\t\t\t\tAxis\t:= NoAxis);\n\t\t\t\tiState \t:= 240;\n\t\t\t\tstrSplit(ADR(sRingString),CHAR_COMMA,0,FALSE,ADR(apsElements));\n\t\t\t\ti \t\t:= -1;\n\t\t\tELSIF fbReadListParameter.Error THEN\n\t\t\t\tErrorID \t:= fbReadListParameter.ErrorID;\n\t\t\t\tErrorIdent \t:= fbReadListParameter.ErrorIdent;\n\t\t\t\tfbReadListParameter(Execute\t:= FALSE,\n\t\t\t\t\t\t\t\t\tAxis\t:= NoAxis);\n\t\t\t\tiState \t\t:= 998;\n\t\t\tEND_IF\n\t\t\n(* ################################################################################ *)\t\n\t// insert Buscoupler to C-0-0578\n(* ################################################################################ *)\t\t\n\t240:\n\t\tREPEAT\n\t\t\ti:= i+1;\n\t\t\t\t{warning 'weitere R911 Nummern müssen agelegt werden'}\n\t\tUNTIL (FUN_TypeCodeIsRexrothIO(TypeCode:=LEFT (apsElements.arWords[uiNumOfElementC578*i+3]^,13)) OR (apsElements.arWords[uiNumOfElementC578*i+3]^ = ''))  \n\t\tEND_REPEAT\n\t\t\t\t\n\t\tIF i > 0 THEN\n\t\t\tFOR j := 1 TO i DO\n\t\t\t\t// Build STRING for 1 Axis \n\t\t\t\tarAxisString[j] := '';\n\t\t\t\t// Comma \n\t\t\t\tstrComma := ',';\n\t\t\t\t\n\t\t\t\t//combine Elemenst to C-0-0578\n\t\t\t\t// example A94,L03100,L05R911173318,'-',NPLC1_E4,S0x00000000,O0x00000008,V94\n\t\t\t\t//Ax\n\t\t\t\tstrConcat(ADR(arAxisString[j]), SIZEOF(arAxisString[j]), apsElements.arWords[uiNumOfElementC578*(j-1)+1]);\n\t\t\t\tstrConcat(ADR(arAxisString[j]), SIZEOF(arAxisString[j]), ADR(strComma));\n\t\t\t\t// L03x\n\t\t\t\tstrConcat(ADR(arAxisString[j]), SIZEOF(arAxisString[j]), apsElements.arWords[uiNumOfElementC578*(j-1)+2]);\n\t\t\t\tstrConcat(ADR(arAxisString[j]), SIZEOF(arAxisString[j]), ADR(strComma));\n\t\t\t\t// L05x\n\t\t\t\tstrConcat(ADR(arAxisString[j]), SIZEOF(arAxisString[j]), apsElements.arWords[uiNumOfElementC578*(j-1)+3]);\n\t\t\t\tstrConcat(ADR(arAxisString[j]), SIZEOF(arAxisString[j]), ADR(strComma));\n\t\t\t\t// -\n\t\t\t\tstrConcat(ADR(arAxisString[j]), SIZEOF(arAxisString[j]), apsElements.arWords[uiNumOfElementC578*(j-1)+4]);\n\t\t\t\tstrConcat(ADR(arAxisString[j]), SIZEOF(arAxisString[j]), ADR(strComma));\n\t\t\t\t// Nx\n\t\t\t\tstrConcat(ADR(arAxisString[j]), SIZEOF(arAxisString[j]), apsElements.arWords[uiNumOfElementC578*(j-1)+5]);\n\t\t\t\tstrConcat(ADR(arAxisString[j]), SIZEOF(arAxisString[j]), ADR(strComma));\n\t\t\t\t// S0x\n\t\t\t\tstrConcat(ADR(arAxisString[j]), SIZEOF(arAxisString[j]), apsElements.arWords[uiNumOfElementC578*(j-1)+6]);\n\t\t\t\tstrConcat(ADR(arAxisString[j]), SIZEOF(arAxisString[j]), ADR(strComma));\n\t\t\t\t// O0x\n\t\t\t\tstrConcat(ADR(arAxisString[j]), SIZEOF(arAxisString[j]), apsElements.arWords[uiNumOfElementC578*(j-1)+7]);\n\t\t\t\tstrConcat(ADR(arAxisString[j]), SIZEOF(arAxisString[j]), ADR(strComma));\n\t\t\t\t// Vx\n\t\t\t\tstrConcat(ADR(arAxisString[j]), SIZEOF(arAxisString[j]), apsElements.arWords[uiNumOfElementC578*(j-1)+8]);\n\t\t\t\n\t\t\tEND_FOR\n\t\tEND_IF\t\n\t\t\n\t\tk := i+1;\n\t\ti := i -1;\n\n\t\tiState := 250;\n\t\t\n(* ################################################################################ *)\t\n\t// Build Axis/Buscoupler strings \n(* ################################################################################ *)\t\t\t\n\t250:\n\t\t// how many buscoupler in C578?\t\n\t\tREPEAT\n\t\t\ti:= i+1;\n\t\tUNTIL (apsElements.arWords[uiNumOfElementC578*i+3]^ = '')  \n\t\tEND_REPEAT\n\t\n\t\t\t\t\n\t\tFOR j := k TO i DO   \n\t\t\t\t//Delete 'A' at beginning of String\n\t\t\tIF (apsElements.arWords[uiNumOfElementC578*(j-1)+1]^ <> '') THEN\n\t\t\t\tptString := apsElements.arWords[uiNumOfElementC578*(j-1)+1]+1;\n\t\t\tELSE\n\t\t\t\tptString := apsElements.arWords[uiNumOfElementC578*(j-1)+1];\n\t\t\tEND_IF\n\t\t\t\n\t\t\tiSercosAddressTemp :=  STRING_TO_INT(ptString^);\t\n\t\t\t\n\t\t\t// Check if IO in SercosIOCmdConfig and set Status depending SercosIOCmdConfig.Active\n\t\t\tFOR l := 1 TO MAX_SERCOS_IO DO\n\t\t\t\tIF SercosIOCmdConfig[l].SercosAddress = iSercosAddressTemp THEN\n\t\t\t\t\t// Build String for C578\t\n\t\t\t\t\tarAxisString[j] := '';\n\t\t\t\t\t// Comma \n\t\t\t\t\tstrComma := ',';\n\t\n\t\t\t\t\t//combine Elemenst to C-0-0578\n\t\t\t\t\t// example A94,L03100,L05R911173318,'-',NPLC1_E4,S0x00000000,O0x00000008,V94\n\t\t\t\t\t//Ax\n\t\t\t\t\tstrConcat(ADR(arAxisString[j]), SIZEOF(arAxisString[j]), apsElements.arWords[uiNumOfElementC578*(j-1)+1]);\n\t\t\t\t\tstrConcat(ADR(arAxisString[j]), SIZEOF(arAxisString[j]), ADR(strComma));\n\t\t\t\t\t// L03x\n\t\t\t\t\tstrConcat(ADR(arAxisString[j]), SIZEOF(arAxisString[j]), apsElements.arWords[uiNumOfElementC578*(j-1)+2]);\n\t\t\t\t\tstrConcat(ADR(arAxisString[j]), SIZEOF(arAxisString[j]), ADR(strComma));\n\t\t\t\t\t// L05x\n\t\t\t\t\tstrConcat(ADR(arAxisString[j]), SIZEOF(arAxisString[j]), apsElements.arWords[uiNumOfElementC578*(j-1)+3]);\n\t\t\t\t\tstrConcat(ADR(arAxisString[j]), SIZEOF(arAxisString[j]), ADR(strComma));\n\t\t\t\t\t// -\n\t\t\t\t\tstrConcat(ADR(arAxisString[j]), SIZEOF(arAxisString[j]), apsElements.arWords[uiNumOfElementC578*(j-1)+4]);\n\t\t\t\t\tstrConcat(ADR(arAxisString[j]), SIZEOF(arAxisString[j]), ADR(strComma));\n\t\t\t\t\t// N\n\t\t\t\t\tstrConcat(ADR(arAxisString[j]), SIZEOF(arAxisString[j]), apsElements.arWords[uiNumOfElementC578*(j-1)+5]);\n\t\t\t\t\tstrConcat(ADR(arAxisString[j]), SIZEOF(arAxisString[j]), ADR(strComma));\n\t\t\t\t\t// Status\n\t\t\t\t\tIF SercosIOCmdConfig[l].Active THEN\n\t\t\t\t\t\tstrTemp := 'S0x00000000';\n\t\t\t\t\tELSE\n\t\t\t\t\t\tstrTemp := 'S0x00000002';\n\t\t\t\t\tEND_IF\n\t\t\t\t\tstrConcat(ADR(arAxisString[j]), SIZEOF(arAxisString[j]), ADR(strTemp));\n\t\t\t\t\tstrConcat(ADR(arAxisString[j]), SIZEOF(arAxisString[j]), ADR(strComma));\n\t\t\t\t\t// 0Ox\n\t\t\t\t\tstrConcat(ADR(arAxisString[j]), SIZEOF(arAxisString[j]), apsElements.arWords[uiNumOfElementC578*(j-1)+7]);\n\t\t\t\t\tstrConcat(ADR(arAxisString[j]), SIZEOF(arAxisString[j]), ADR(strComma));\n\t\t\t\t\t// Vx\n\t\t\t\t\tstrConcat(ADR(arAxisString[j]), SIZEOF(arAxisString[j]), apsElements.arWords[uiNumOfElementC578*(j-1)+5]);\n\t\t\t\tEND_IF\n\t\t\t\t// End LOOP\n\t\t\t\tIF SercosIOCmdConfig[l].SercosAddress = 0 THEN \n\t\t\t\t\tl := MAX_SERCOS_IO + 1;\n\t\t\t\tEND_IF\n\t\t\tEND_FOR\n\t\t\t\n\t\tEND_FOR\n\t\n\t\tj := j-1;\n\t\tiState := 260;\n\n(* ################################################################################ *)\t\n\t// Build C-0-0578 \n(* ################################################################################ *)\t\t\t\n\t260:\t\n\t\t//BUILD C-0-0478\n\t\tstrC578 :='';\n\t\t\n\t\tIF j > 0 THEN \n\t\t\tFOR i := 1 TO j DO\n\t\t\t\tIF i < j THEN\n\t\t\t\t\tstrConcat(ADR(strC578), (SIZEOF(strC578)), ADR(arAxisString[i]));\n\t\t\t\t\tstrConcat(ADR(strC578), (SIZEOF(strC578)), ADR(strComma));\n\t\t\t\tELSE\t\n\t\t\t\t\tstrConcat(ADR(strC578), (SIZEOF(strC578)), ADR(arAxisString[i]));\n\t\t\t\tEND_IF\n\t\t\tEND_FOR\n\t\tEND_IF\n\n\t\tiState := 270;\n\n\n(* ################################################################################ *)\t\n\t// Write C-0-0478\n(* ################################################################################ *)\t\t\t\n\t270: \n\t\tiState := 280;\t\n\t//\tWriteC578(\n\t//\t\tExecute:= TRUE, \n\t//\t\tParameterNumber:= FP_C_0_0578, \n\t//\t\tNoOfBytes:= SIZEOF(strC578), \n\t//\t\tValueAdr:= ADR(strC578), \n\t//\t\tAxis:= NoAxis, \n\t//\t\tDone=> , \n\t//\t\tActive=> );\n    //\n\t//\tIF WriteC578.Done THEN\n\t//\t\tWriteC578(Execute\t:= FALSE,\n\t//\t\t\t\tAxis\t:= NoAxis);\n\t//\t\ti\t\t:= 0;\n\t//\t\t\t\t\n\t//\n\t//\tELSIF WriteC578.Error THEN\n\t//\t\tErrorID \t:= WriteC578.ErrorID;\n\t//\t\tErrorIdent \t:= WriteC578.ErrorIdent;\n\t//\t\tWriteC578(Execute\t:= FALSE,\n\t//\t\t\t\t\t\t\tAxis\t:= NoAxis);\n\t//\t\tiState \t\t:= 998;\n\t//\tEND_IF\n\t\t\t\t\t\t\n*)\t\t\n(* ################################################################################ *)\t\n// create String for UserDefs.cfg\n(* ################################################################################ *)\t\t\t\t\t\t\n\t280:\n\t\t(* Example:\n\t\t;---------- Master.0 ----------\n\t\t[SercosIO.Master.0]\n\t\tSlaveDeactAddr = 20\n\t\tSlaveDeactAddr = 32\n\t\tSlaveDeactAddr = 35\n\t\tSlaveDeactAddr = 56\n\t\tSlaveAddr = 40, DeactModule= 2, 4\n\t\tSlaveAddr = 55, DeactLastModules= 3\n\n\t\t;------------------------------\n\t\t*)\n\t\tIF NOT (iLineCfg > 1) THEN\n\t\t\t//\tHeader\n\t\t\tasStringCmdCfg[iLineCfg] := ';--------------- Sercos IO --------------- ';\n\t\t\tiLineCfg := iLineCfg + 1;\t \t// next line\n\t\t\tasStringCmdCfg[iLineCfg] := '[SercosIO.Master.0]';\t\n\t\t\tiLineCfg := iLineCfg +1;\t \t// next line\n\t\tEND_IF\n\t\tFOR i := 1 TO iMAX_SERCOS_IO DO\n\t\t\tIF refastSercosIOCmdConfig[i].iSercosAddress <> 0 THEN \n\t\t\t\t// deactivate only modules\n\t\t\t\tIF refastSercosIOCmdConfig[i].bActive THEN\n\t\t\t\t\tasStringCmdCfg[iLineCfg] := '';\n\t\t\t\t\tbWriteThisLine := FALSE;\n\t\t\t\t\tsTemp2 := 'SlaveAddr = ';\n\t\t\t\t\t//strConcat(ADR\t(arStringCmdCfg[iLineCfg]), SIZEOF(arStringCmdCfg[iLineCfg]) ,\tADR(strTemp));\n\t\t\t\t\tIL_CONCAT(ADR(asStringCmdCfg[iLineCfg]), ADR(sTemp2), ADR(asStringCmdCfg[iLineCfg]), SIZEOF(asStringCmdCfg[iLineCfg]));\n\t\t\t\t\tsTemp2 := INT_TO_STRING (refastSercosIOCmdConfig[i].iSercosAddress);\n\t\t\t\t\t//strConcat(ADR\t(arStringCmdCfg[iLineCfg]), SIZEOF(arStringCmdCfg[iLineCfg]) ,\tADR(strTemp));\n\t\t\t\t\tIL_CONCAT(ADR(asStringCmdCfg[iLineCfg]), ADR(sTemp2), ADR(asStringCmdCfg[iLineCfg]), SIZEOF(asStringCmdCfg[iLineCfg]));\n\t\t\t\t\tsTemp2 :=  ', DeactModule = ';\n\t\t\t\t\t//strConcat(ADR\t(arStringCmdCfg[iLineCfg]), SIZEOF(arStringCmdCfg[iLineCfg]) ,\tADR(strTemp));\n\t\t\t\t\tIL_CONCAT(ADR(asStringCmdCfg[iLineCfg]), ADR(sTemp2), ADR(asStringCmdCfg[iLineCfg]), SIZEOF(asStringCmdCfg[iLineCfg]));\n\t\t\t\t\tFOR j := 1 TO iMAX_MODULE_ON_SERCOS_IO DO\n\t\t\t\t\t\tIF NOT refastSercosIOCmdConfig[i].astIOModule[j].bActive AND refastSercosIOCmdConfig[i].astIOModule[j].bConfigured  THEN\n\t\t\t\t\t\t\tIF bWriteThisLine THEN\n\t\t\t\t\t\t\t\tsTemp2 :=  ', ';\n\t\t\t\t\t\t\t\t//strConcat(ADR\t(arStringCmdCfg[iLineCfg]), SIZEOF(arStringCmdCfg[iLineCfg]) ,\tADR(strTemp));\n\t\t\t\t\t\t\t\tIL_CONCAT(ADR(asStringCmdCfg[iLineCfg]), ADR(sTemp2), ADR(asStringCmdCfg[iLineCfg]), SIZEOF(asStringCmdCfg[iLineCfg]));\n\t\t\t\t\t\t\tEND_IF\t\n\t\t\t\t\t\t\tsTemp2 := INT_TO_STRING (j);\n\t\t\t\t\t\t\t//strConcat(ADR\t(arStringCmdCfg[iLineCfg]), SIZEOF(arStringCmdCfg[iLineCfg]) ,\tADR(strTemp));\n\t\t\t\t\t\t\tIL_CONCAT(ADR(asStringCmdCfg[iLineCfg]), ADR(sTemp2), ADR(asStringCmdCfg[iLineCfg]), SIZEOF(asStringCmdCfg[iLineCfg]));\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tbWriteThisLine := TRUE;\n\t\t\t\t\t\tEND_IF\n\t\t\t\t\tEND_FOR\n\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\tIF NOT bWriteThisLine THEN\n\t\t\t\t\t\tsTemp2 := \tasStringCmdCfg[iLineCfg];\n\t\t\t\t\t\tasStringCmdCfg[iLineCfg] := '; ';\n\t\t\t\t\t\t//strConcat(ADR (arStringCmdCfg[iLineCfg]), SIZEOF(arStringCmdCfg[iLineCfg]) ,ADR(strTemp));\n\t\t\t\t\t\tIL_CONCAT(ADR(asStringCmdCfg[iLineCfg]), ADR(sTemp2), ADR(asStringCmdCfg[iLineCfg]), SIZEOF(asStringCmdCfg[iLineCfg]));\n\t\t\t\t\tEND_IF\n\t\t\t\t\t\n\t\t\t\t\tIF NOT (asStringCmdCfg[iLineCfg]= asStringActCfg[iLineCfg]) THEN\n\t\t\t\t\t\tOUT_bReboot := TRUE;\n\t\t\t\t\tEND_IF\n\t\t\t\t\tiLineCfg := iLineCfg +1; \t// next line\n\t\t\t\t\t\t\n\t\t\t\tELSE\n\t\t\t\t\t// deactivate complete sercos slave\t\t\t\n\t\t\t\t\tasStringCmdCfg[iLineCfg] := '';\n\t\t\t\t\t\t\t\t\n\t\t\t\t\tsTemp2 := 'SlaveDeactAddr = ';\n\t\t\t\t\t//strConcat(ADR\t(arStringCmdCfg[iLineCfg]), SIZEOF(arStringCmdCfg[iLineCfg]) ,\tADR(strTemp));\n\t\t\t\t\tIL_CONCAT(ADR(asStringCmdCfg[iLineCfg]), ADR(sTemp2), ADR(asStringCmdCfg[iLineCfg]), SIZEOF(asStringCmdCfg[iLineCfg]));\n\t\t\t\t\tsTemp2 := INT_TO_STRING (refastSercosIOCmdConfig[i].iSercosAddress);\n\t\t\t\t\t//strConcat(ADR\t(arStringCmdCfg[iLineCfg]), SIZEOF(arStringCmdCfg[iLineCfg]) ,\tADR(strTemp));\n\t\t\t\t\tIL_CONCAT(ADR(asStringCmdCfg[iLineCfg]), ADR(sTemp2), ADR(asStringCmdCfg[iLineCfg]), SIZEOF(asStringCmdCfg[iLineCfg]));\n\t\n\t\t\t\t\tIF NOT (asStringCmdCfg[iLineCfg]= asStringActCfg[iLineCfg]) THEN\n\t\t\t\t\t\tOUT_bReboot := TRUE;\n\t\t\t\t\tEND_IF\n\t\t\t\t\n\t\t\t\t\tiLineCfg := iLineCfg +1; \t// next line\n\t\t\t\tEND_IF\n\t\t\tELSIF refastSercosIOCmdConfig[i].iSercosAddress = 0 THEN\n\t\t\t\t// End LOOP\n\t \t\t\ti := iMAX_SERCOS_IO + 1;\n\t\t\tEND_IF\t\n\t\tEND_FOR\n\t\t\n\t\tasStringCmdCfg[iLineCfg] := ';-----------------------------------------';\n\t\tiLineCfg := iLineCfg +1;\t \t// next line\n\n\t\tasStringCmdCfg[iLineCfg] := '';\t\n\t\tiLineCfg := iLineCfg +1;\t \t// next line\n\t\t\n\t\tiEOF := iLineCfg -1 ;\t\t\t//End Of File\n\t\t\n\t\tIF IN_bWriteSercosIOAddress THEN \n\t\t\tiState \t\t:= 290;\n\t\tELSE\n\t\t\tiState \t\t:= 299;\n\t\tEND_IF\n\t\t\t\n\n(* ################################################################################ *)\t\n\t// Check all I/Os which are found in C-0-0510 (only address of SIII Buscoupler)\n(* ################################################################################ *)\t\t\t\n\t290: \t\t\t\n\t\tj := 1;\n\t\tFOR i := 1 TO iMAX_SERCOS_IO DO\n\t\t\trefastSercosIOConfigError[i].bError := FALSE;\n\t\t\trefastSercosIOConfigError[i].iSercosAddress := 0;\n\t\t\trefastSercosIOConfigError[i].sErrorMessage := '';\n\t\t\tIF refastSercosIOCmdConfig[i].bActive THEN\n\t\t\t\tIF NOT (apiPointerToC510[j] = 0) THEN\n\t\t\t\t\tapiPointerToC510[j]^ := refastSercosIOCmdConfig[i].iSercosAddress;\n\t\t\t\t\tj := j+1;\n\t\t\t\tELSE \n\t\t\t\t\trefastSercosIOConfigError[i].bError := TRUE;\n\t\t\t\t\trefastSercosIOConfigError[i].iSercosAddress := refastSercosIOCmdConfig[i].iSercosAddress;;\n\t\t\t\t\n\t\t\t\t\tsTemp2 :='';\n\t\t\t\t\trefastSercosIOConfigError[i].sErrorMessage := 'IO ';\n\t\t\t\t\tsTemp2 := refastSercosIOCmdConfig[i].sName;\n\t\t\t\t\t//strConcat(ADR\t(SercosIOConfigError[i].ErrorMessage), (SIZEOF(SercosIOConfigError[i].ErrorMessage)) ,\tADR(strTemp));\n\t\t\t\t\tIL_CONCAT(ADR(refastSercosIOConfigError[i].sErrorMessage), ADR(sTemp2), ADR(refastSercosIOConfigError[i].sErrorMessage), SIZEOF(refastSercosIOConfigError[i].sErrorMessage));\n\t\t\t\t\tsTemp2 := ' with sercos address ';\n\t\t\t\t\t//strConcat(ADR\t(SercosIOConfigError[i].ErrorMessage), (SIZEOF(SercosIOConfigError[i].ErrorMessage)) ,\tADR(strTemp));\n\t\t\t\t\tIL_CONCAT(ADR(refastSercosIOConfigError[i].sErrorMessage), ADR(sTemp2), ADR(refastSercosIOConfigError[i].sErrorMessage), SIZEOF(refastSercosIOConfigError[i].sErrorMessage));\n\t\t\t\t\tsTemp2 := INT_TO_STRING(refastSercosIOConfigError[i].iSercosAddress);\n\t\t\t\t\t//strConcat(ADR\t(SercosIOConfigError[i].ErrorMessage), (SIZEOF(SercosIOConfigError[i].ErrorMessage)) ,\tADR(strTemp));\n\t\t\t\t\tIL_CONCAT(ADR(refastSercosIOConfigError[i].sErrorMessage), ADR(sTemp2), ADR(refastSercosIOConfigError[i].sErrorMessage), SIZEOF(refastSercosIOConfigError[i].sErrorMessage));\n\t\t\t\t\tsTemp2 := ' not found on bus';\t\t\t\t\n\t\t\t\t\tIL_CONCAT(ADR(refastSercosIOConfigError[i].sErrorMessage), ADR(sTemp2), ADR(refastSercosIOConfigError[i].sErrorMessage), SIZEOF(refastSercosIOConfigError[i].sErrorMessage));\n\t\t\t\t\tbErrorTemp := TRUE;\n\t\t\t\t\t\n\t\t\t\t\tIF sDiagMessageInt = '' THEN\n\t\t\t\t\t\tsDiagMessageInt := refastSercosIOConfigError[i].sErrorMessage;\n\t\t\t\t\tEND_IF\t\t\t\n\t\t\t\t\t\n\t\t\t\tEND_IF\n\t\t\tEND_IF\n\t\tEND_FOR\n\t\t\n\t\tIF bErrorTemp THEN  \n\t\t\tOUT_ErrorID := \tRESOURCE_ERROR;\n\t\t\tOUT_ErrorIdent.Table :=\tUSER1_TABLE;       \n\t\t\tOUT_ErrorIdent.Additional1 := 16#F0003;\n\t\t\tOUT_ErrorIdent.Additional2 := 16#F0000;\n\t\t\t\n\t\t\tiState \t\t:= 998;\n\t\tELSE\n\t\t\tiState \t\t:= 295;\n\t\tEND_IF\t\n\t\t\n(* ################################################################################ *)\t\n\t// Write C-0-0510 (only address of SIII Buscoupler)\n(* ################################################################################ *)\t\t\t\t\t\n\t295:\t\n\t\tfbWriteListParameter(\n\t\t\tExecute\t\t\t:= TRUE, \n\t\t\tParameterNumber\t:= GVL_C_Param_ID.FP_C_0_0510, \n\t\t\tNoOfBytes\t\t:= uiLengthArC510, \n\t\t\tValueAdr\t\t:= ADR(aiC510), \n\t\t\tAxis\t\t\t:= NoAxis );\n\t\t\t\t\n\t\tIF fbWriteListParameter.Done THEN\n\t\t\tfbWriteListParameter(Execute\t:= FALSE,\n\t\t\t\t\t\t\t\tAxis\t:= NoAxis);\n\t\t\tiState \t:= 299;\n\t\t\ti\t\t:= 0;\n\t\tELSIF fbWriteListParameter.Error THEN\n\t\t\tOUT_ErrorID \t:= fbWriteListParameter.ErrorID;\n\t\t\tOUT_ErrorIdent \t:= fbWriteListParameter.ErrorIdent;\n\t\t\tfbWriteListParameter(Execute\t:= FALSE,\n\t\t\t\t\t\t\t\tAxis\t:= NoAxis);\n\t\t\tiState \t\t:= 998;\n\t\tEND_IF\n\t\n\t\t\n(* ################################################################################ *)\t\n\t// End\n(* ################################################################################ *)\t\t\t\t\t\n\t299:\n\t\tiState := 300;\t\t\n\nEND_CASE","LineInfoPersistence":"(string)7c732b83-8dac-49b3-8214-0909a2dbc00b_Impl_LineIds"}}}},"Interface":{"@Type":"a9ed5b7e","@Value":{"TextDocument":{"@Type":"f3878285","@Value":{"TextBlobForSerialisation":"(string)METHOD M_2ConfigSercosIO : BOOL\n","LineInfoPersistence":"(string)7c732b83-8dac-49b3-8214-0909a2dbc00b_Decl_LineIds"}}}}}},"TypeInfos":{"3b83b776":"{3b83b776-fb25-43b8-99f2-3c507c9143fc}","a9ed5b7e":"{a9ed5b7e-75c5-4651-af16-d2c27e98cb94}","f3878285":"{f3878285-8e4f-490b-bb1b-9acbb7eb04db}","f8a58466":"{f8a58466-d7f6-439f-bbb8-d4600e41d099}","string":"System.String"}}},"FormatVersion":"1.0"}